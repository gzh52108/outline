<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>13.组件化todolist</title>
    <link rel="stylesheet" href="./css/bootstrap.css">
</head>
<body>
    <h1>13.组件化todolist</h1>
    <div id="app">
       <todo-list></todo-list>
    </div>
    <template id="todoContent">
        <div>
            <table class="table">
            <thead>
                <tr>
                    <th scope="col"><input type="checkbox" /></th>
                    <th scope="col">#</th>
                    <th scope="col">代办事项</th>
                    <th scope="col">添加时间</th>
                    <th scope="col">是否完成</th>
                    <th scope="col">操作</th>
                </tr>
            </thead>
            <tbody>
                <!-- 在tbody中直接使用todo-item组件会导致浏览器解析错误 -->
                <!-- <todo-item v-for="(item,idx) in list" :item="item" :idx="idx"></todo-item> -->
                <!-- 解决方案如下 -->
                <tr is="todo-item" v-for="(item,idx) in list" :item="item" :idx="idx"></tr>
            </tbody>
        </table>
            
        </div>
    </template>
    <template id="todoItem">
        <tr @click="selectItem(item.id)">
            <td><input type="checkbox"></td>
            <th scope="row">{{idx+1}}</th>
            <td>{{item.todo}}</td>
            <td>{{item.addtime}}</td>
            <td>{{item.done ? '是' : '否'}}</td>
            <td>
                <button class="btn btn-outline-primary btn-sm"
                    v-on:click.stop="completeItem(item.id)">{{item.done ? '取消' : '完成'}}</button>
                <button class="btn btn-outline-danger btn-sm" v-on:click.stop.="removeItem(item.id,$event)">删除</button>
            </td>
        </tr>
    </template>
    <script src="js/vue.js"></script>
    <script>
        /**
            * 13.组件化todolist
         */
        const todoItem = {
            props:['item','idx'],
            template:`#todoItem`
        }
        const todoForm = {
            data(){
                return {
                    todo:''
                }
            },
            methods:{
                addItem(){

                }
            },
            template:`<div>
                <div class="input-group mb-3">
                    <input type="text" class="form-control" ref="input" v-model="todo" @keyup.enter="addItem">
                    <button class="btn btn-success" @click="addItem">添加</button>
                </div>
            </div>`
        }
        const todoControl = {
            template:`<div>
                <div class="text-end">
                    <button class="btn btn-primary btn-sm">批量完成</button>
                    <button class="btn btn-danger btn-sm">批量删除</button>
                </div>
            </div>`
        }
        const todoContent = {
            props:['list'],
            template:`#todoContent`,
            components:{
                todoItem
            }
        }
        const todoFooter = {
            // 接收父组件传入的数据
            props:['list'],
            computed:{
                donelist(){
                    return this.list.filter(item=>item.done)
                },
                undonelist(){
                    return this.list.filter(item=>!item.done)
                }
            },
            template:`<div class="p-3">
                总数：{{list.length}}，完成：{{donelist.length}}，未完成：{{undonelist.length}}
            </div>`
        }
        Vue.component('TodoList',{
            data(){
                return {
                    datalist: [{
                        id: 1,
                        todo: '定个小目标，全球旅行',
                        done: true,
                        addtime: Date.now()
                    }, {
                        id: 2,
                        todo: '赚他一个亿津巴布韦币',
                        done: false,
                        addtime: Date.now() + 3600 * 1000
                    }, {
                        id: 3,
                        todo: '迎娶白富美，达到人生巅峰',
                        done: false,
                        addtime: Date.now() + 3600 * 1000 * 5
                    }],
                }
            },
            template:`
                <div class="container">
                    <todo-form></todo-form>
                    <todo-control></todo-control>
                    <todo-content :list="datalist"></todo-content>
                    <todo-footer :list="datalist"></todo-footer>
                </div>
            `,
            components:{
                todoForm,
                todoControl,
                todoContent,
                todoFooter
            }
        })
        

        const vm = new Vue({
           el:'#app',
           data:{
               
           },
        })
    </script>
</body>
</html>